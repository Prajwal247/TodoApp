{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Button,Container,TextInput,Group,Title,Paper,PasswordInput,Text,Alert}from'@mantine/core';import{useNavigate}from'react-router-dom';import{useForm}from'react-hook-form';import{yupResolver}from'@hookform/resolvers/yup';import*as yup from'yup';import{useAuth}from'../Context/Auth';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const schema=yup.object().shape({username:yup.string().email('Invalid email').required('Email is required'),password:yup.string().required('Password is required')});const Login=()=>{var _errors$username,_errors$password;const navigate=useNavigate();const{register,handleSubmit,formState:{errors}}=useForm({resolver:yupResolver(schema)});const{isAuthenticated,login}=useAuth();const[loginError,setLoginError]=useState(null);useEffect(()=>{if(isAuthenticated){navigate('/');}},[]);const handleLogin=async data=>{try{const formData=new URLSearchParams();formData.append('username',data.username);formData.append('password',data.password);const response=await axios.post('http://127.0.0.1:8000/token',formData);console.log('Login success:',response.data);login(response.data.access_token);navigate('/');}catch(error){console.error('Login error:','Invalid Credentials');setLoginError('Login failed. Please try again.');}};const toRegistration=()=>{navigate('/registration');};return/*#__PURE__*/_jsxs(Container,{size:420,my:40,children:[/*#__PURE__*/_jsx(Title,{align:\"center\",children:\"Login\"}),/*#__PURE__*/_jsxs(Paper,{withBorder:true,shadow:\"md\",p:30,mt:30,radius:\"md\",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(handleLogin),children:[/*#__PURE__*/_jsx(TextInput,{label:\"Email\",placeholder:\"you@example.com\",...register('username'),error:(_errors$username=errors.username)===null||_errors$username===void 0?void 0:_errors$username.message,required:true}),/*#__PURE__*/_jsx(PasswordInput,{label:\"Password\",placeholder:\"Your password\",...register('password'),error:(_errors$password=errors.password)===null||_errors$password===void 0?void 0:_errors$password.message,required:true,mt:\"md\"}),/*#__PURE__*/_jsx(Group,{position:\"apart\",mt:\"md\",children:/*#__PURE__*/_jsx(Button,{type:\"submit\",children:\"Login\"})})]}),loginError&&/*#__PURE__*/_jsx(Alert,{color:\"red\",mt:\"md\",children:loginError}),/*#__PURE__*/_jsxs(Text,{align:\"center\",mt:\"md\",children:[\"Don't have an account yet?\",' ',/*#__PURE__*/_jsx(Button,{variant:\"subtle\",onClick:toRegistration,children:\"Register\"})]})]})]});};export default Login;","map":{"version":3,"names":["React","useEffect","useState","Button","Container","TextInput","Group","Title","Paper","PasswordInput","Text","Alert","useNavigate","useForm","yupResolver","yup","useAuth","axios","jsx","_jsx","jsxs","_jsxs","schema","object","shape","username","string","email","required","password","Login","_errors$username","_errors$password","navigate","register","handleSubmit","formState","errors","resolver","isAuthenticated","login","loginError","setLoginError","handleLogin","data","formData","URLSearchParams","append","response","post","console","log","access_token","error","toRegistration","size","my","children","align","withBorder","shadow","p","mt","radius","onSubmit","label","placeholder","message","position","type","color","variant","onClick"],"sources":["/Users/prajwalthapa/Desktop/todoapp/frontend/src/Pages/Login.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport {\n  Button,\n  Container,\n  TextInput,\n  Group,\n  Title,\n  Paper,\n  PasswordInput,\n  Text,\n  Alert\n} from '@mantine/core';\nimport { useNavigate } from 'react-router-dom';\nimport { useForm } from 'react-hook-form';\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport * as yup from 'yup';\nimport { useAuth } from '../Context/Auth';\nimport axios from 'axios';\n\nconst schema = yup.object().shape({\n  username: yup.string().email('Invalid email').required('Email is required'),\n  password: yup.string().required('Password is required'),\n});\n\nconst Login: React.FC = () => {\n  const navigate = useNavigate();\n  const { register, handleSubmit, formState: { errors } } = useForm({\n    resolver: yupResolver(schema),\n  });\n\n  const {isAuthenticated, login } = useAuth();\n  const [loginError, setLoginError] = useState<string | null>(null);\n\n  useEffect(() => {\n    if(isAuthenticated){\n      navigate('/')\n    }\n  },[])\n  const handleLogin = async (data: any) => {\n    try {\n      const formData = new URLSearchParams();\n      formData.append('username', data.username);\n      formData.append('password', data.password);\n  \n      const response = await axios.post('http://127.0.0.1:8000/token', formData);\n      console.log('Login success:', response.data);\n      login(response.data.access_token);\n      navigate('/');\n    } catch (error) {\n      console.error('Login error:', 'Invalid Credentials');\n      setLoginError('Login failed. Please try again.');\n    }\n  };\n\n  const toRegistration = () => {\n    navigate('/registration');\n  };\n\n  return (\n    <Container size={420} my={40}>\n      <Title align=\"center\">Login</Title>\n      <Paper withBorder shadow=\"md\" p={30} mt={30} radius=\"md\">\n        <form onSubmit={handleSubmit(handleLogin)}>\n          <TextInput\n            label=\"Email\"\n            placeholder=\"you@example.com\"\n            {...register('username')}\n            error={errors.username?.message}\n            required\n          />\n          <PasswordInput\n            label=\"Password\"\n            placeholder=\"Your password\"\n            {...register('password')}\n            error={errors.password?.message}\n            required\n            mt=\"md\"\n          />\n          <Group position=\"apart\" mt=\"md\">\n            <Button type=\"submit\">Login</Button>\n          </Group>\n        </form>\n        {loginError && (\n          <Alert color=\"red\" mt=\"md\">\n            {loginError}\n          </Alert>\n        )}\n        <Text align=\"center\" mt=\"md\">\n          Don't have an account yet?{' '}\n          <Button variant=\"subtle\" onClick={toRegistration}>\n            Register\n          </Button>\n        </Text>\n      </Paper>\n    </Container>\n  );\n};\n\nexport default Login;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}